<!doctype html>
<html lang="ko">
<head><meta charset="utf-8"><title>NEIS Grid Unit Tests</title></head>
<body>
  <h2>neis_grid.js unit tests</h2>
  <div id="results"></div>
  <script src="neis_grid.js"></script>
  <script>
    const out = document.getElementById('results');
    function pass(msg){ const d=document.createElement('div'); d.style.color='green'; d.textContent = 'PASS: ' + msg; out.appendChild(d); }
    function fail(msg){ const d=document.createElement('div'); d.style.color='red'; d.textContent = 'FAIL: ' + msg; out.appendChild(d); }

    try{
      // test getClassKey
      const r1 = { GRADE:'1', CLASS_NM:'3' };
      const k1 = neisGrid.getClassKey(r1);
      if (k1 === '1-3') pass('getClassKey basic'); else fail('getClassKey basic -> ' + k1);

      // test parseYmdToDay
      const dow = neisGrid.parseYmdToDay('20251020'); // 2025-10-20 is Monday (1)
      if (dow === 1) pass('parseYmdToDay basic'); else fail('parseYmdToDay expected 1 got ' + dow);

      // buildGrid + render small snapshot
      const smallRows = [
        { ALL_TI_YMD:'20251020', PERIO:'1', GRADE:'1', CLASS_NM:'1', ITRT_CNTNT:'수학' },
        { ALL_TI_YMD:'20251020', PERIO:'2', GRADE:'1', CLASS_NM:'1', ITRT_CNTNT:'영어' }
      ];
      const g = neisGrid.buildGrid(smallRows);
      if (g.classes.includes('1-1') && g.periods.includes(1) && g.periods.includes(2)) pass('buildGrid basic'); else fail('buildGrid contents wrong ' + JSON.stringify(g));

      // renderGridTo should not throw
      const container = document.createElement('div');
      neisGrid.renderGridTo(container, smallRows, 'test title', { showOnlyVisitWeekday:false });
      pass('renderGridTo runs');

    } catch(e){ fail('exception ' + e.message); }
  </script>
</body>
</html>